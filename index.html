<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make MP3s - Convert Music Playlists to MP3s</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @font-face {
            font-family: 'Helvetica Neue Bold';
            src: url('fonts/HelveticaNeue Bold.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Helvetica, 'Segoe UI', Arial, sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
            line-height: 1.6;
        }

        .content-wrapper {
            background-image: url('images/web-bg.png');
            background-size: cover;
            background-position: center top;
            background-repeat: no-repeat;
            background-attachment: fixed;
            padding-bottom: 5rem;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Helvetica Neue Bold', Helvetica, 'Segoe UI', Arial, sans-serif;
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 3rem;
            background-image: url('images/web-bg.png');
            background-size: cover;
            background-position: center top;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }

        .logo { width: 40px; height: 40px; }

        .nav-links { display: flex; gap: 2rem; list-style: none; }
        .nav-links a { color: #b0b0b0; text-decoration: none; transition: all 0.3s ease; }
        .nav-links a:hover { color: #ffffff; }

        .nav-icons { display: flex; gap: 1.5rem; align-items: center; }
        .nav-icons a { color: #b0b0b0; text-decoration: none; font-size: 1.2rem; transition: all 0.3s ease; }
        .nav-icons a:hover { color: #ffffff; }

        /* --- FIXED: Dropdown & Modal Styles (Outside Media Query) --- */
        .dropdown-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 35px;
            background-color: #2a2a2a;
            min-width: 260px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.5);
            border-radius: 8px;
            z-index: 1000;
            overflow: hidden;
            border: 1px solid #444;
        }

        .dropdown-menu.show { display: block; }

        .dropdown-item {
            display: block;
            padding: 12px 15px;
            color: #b0b0b0;
            text-decoration: none;
            transition: background 0.2s;
            border-bottom: 1px solid #3a3a3a;
        }

        .dropdown-item:last-child { border-bottom: none; }
        .dropdown-item:hover { background-color: #3a3a3a; color: #fff; }

        .modal-overlay {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .modal-box {
            background-color: #1a1a1a;
            padding: 2.5rem;
            border-radius: 15px;
            border: 1px solid #444;
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
        }

        .google-btn {
            background-color: #ffffff;
            color: #1a1a1a;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            font-weight: bold;
            transition: transform 0.2s;
            margin-top: 1rem;
        }

        /* Hero & Features */
        .hero { text-align: center; padding: 4rem 3rem; max-width: 1200px; margin: 0 auto; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 0.75rem; }
        .hero p { color: #b0b0b0; margin-bottom: 1.5rem; }

        .btn {
            display: inline-block;
            padding: 0.8rem 2rem;
            background-color: #007AFF;
            color: #ffffff;
            text-decoration: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .btn-gold { background-color: #D4AF37; color: #1a1a1a; }
        .btn-gold:hover { background-color: #F4D03F; }

        .feature-section {
            display: flex;
            align-items: center;
            gap: 2rem;
            max-width: 1400px;
            margin: 3rem auto 5rem;
            padding: 0 4rem;
        }

        .feature-image img { width: 100%; max-width: 450px; }

        .premium-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            padding: 2rem;
            background-image: url('images/prem-bg.png');
            background-size: cover;
            height: 300px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .feature-section { flex-direction: column; padding: 0 1rem; }
            .premium-section { flex-direction: column; height: auto; padding: 3rem 1rem; }
        }
    </style>
</head>
<body>

    <nav>
        <img src="images/logo.png" alt="Logo" class="logo">
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="downloads.html">Downloads</a></li>
            <li><a href="#donate">Donate</a></li>
            <li><a href="#feedback">Feedback</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
        <div class="nav-icons">
            <a href="#search"><i class="fas fa-search"></i></a>
            <div class="account-container" style="position: relative; display: inline-block;">
                <a href="javascript:void(0)" onclick="toggleDropdown()">
                    <i class="fas fa-user"></i>
                </a>
                <div id="user-dropdown" class="dropdown-menu"></div>
            </div>
            <a href="#cart"><i class="fas fa-shopping-cart"></i></a>
        </div>
    </nav>

    <div class="content-wrapper">
        <section class="hero">
            <h1>A Better Way to Convert Music Playlists to MP3s</h1>
            <p>Designed for artists, music collectors, and DJs who need clean, consistent MP3s.</p>
            <a href="downloads.html" class="btn">Download Make MP3s Free Edition</a>
        </section>

        <section class="feature-section">
            <div class="feature-image"><img src="images/app-screenshot.png" alt="Screenshot"></div>
            <div class="feature-content">
                <h2>What is Make MP3s?</h2>
                <p>Simple music conversion software designed to convert songs into high quality MP3 files from a wide range of streaming platforms.</p>
            </div>
        </section>
    </div>

    <section class="premium-section">
        <div class="premium-animation"><img src="images/prem-spin.gif" alt="Premium"></div>
        <div class="premium-content">
            <h2>Make MP3s Premium Edition</h2>
            <p>Unlimited Downloads, volume leveling, and more.</p>
            <a href="#premium" class="btn btn-gold">Get Premium Edition</a>
        </div>
    </section>

    <div id="auth-modal" class="modal-overlay">
        <div class="modal-box">
            <span style="position:absolute; top:15px; right:20px; cursor:pointer; font-size:28px;" onclick="closeAuthModal()">&times;</span>
            <h2>Welcome Back</h2>
            <p style="color: #b0b0b0; margin-bottom: 20px;">Sign in to access your Make MP3s account.</p>
            <button onclick="handleGoogleLogin()" class="google-btn">
                <i class="fab fa-google"></i> Continue with Google
            </button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAi9fITJ_WhYup1P7CBG_HTxG2BMwJxX8U",
            authDomain: "make-mp3s.firebaseapp.com",
            projectId: "make-mp3s",
            storageBucket: "make-mp3s.firebasestorage.app",
            messagingSenderId: "530983812032",
            appId: "1:530983812032:web:1d059a67673771929b2625"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        const dropdown = document.getElementById("user-dropdown");
        const authModal = document.getElementById("auth-modal");

        // --- FIXED: One-Click Login Logic ---
        window.toggleDropdown = () => {
            if (auth.currentUser) {
                dropdown.classList.toggle("show");
            } else {
                window.openAuthModal();
            }
        };

        window.openAuthModal = () => { authModal.style.display = "flex"; dropdown.classList.remove("show"); };
        window.closeAuthModal = () => authModal.style.display = "none";

        window.handleGoogleLogin = async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                const userRef = doc(db, "users", user.uid);
                const userSnap = await getDoc(userRef);
                if (!userSnap.exists()) {
                    await setDoc(userRef, { email: user.email, subscription: "free", createdAt: new Date() });
                }
                closeAuthModal();
            } catch (error) { console.error(error); }
        };

        window.handleLogout = () => signOut(auth).then(() => window.location.reload());

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                const userRef = doc(db, "users", user.uid);
                const userSnap = await getDoc(userRef);
                const userData = userSnap.exists() ? userSnap.data() : { subscription: 'free' };
                const subType = userData.subscription || 'free';
                
                // FIXED: Added Gold "ACCOUNT" Label
                dropdown.innerHTML = `
                    <div style="padding: 15px; border-bottom: 1px solid #444;">
                        <div style="color: #D4AF37; font-weight: bold; font-size: 0.8rem; margin-bottom: 5px;">ACCOUNT</div>
                        <div style="color: #fff; font-weight: bold;">${user.email}</div>
                        <div style="font-size: 0.85rem; color: #b0b0b0; margin-top: 5px;">
                            Plan: <span style="color: ${subType === 'premium' ? '#D4AF37' : '#fff'}; text-transform: uppercase; font-weight: bold;">${subType}</span>
                        </div>
                    </div>
                    <a href="#settings" class="dropdown-item">Account Settings</a>
                    <a href="javascript:void(0)" onclick="handleLogout()" class="dropdown-item" style="color: #ff4444;">Log Out</a>
                `;
            } else {
                dropdown.innerHTML = ""; // Clear menu when logged out
            }
        });

        window.onclick = (e) => {
            if (!e.target.closest('.account-container')) dropdown.classList.remove('show');
            if (e.target === authModal) closeAuthModal();
        };
    </script>
</body>
</html>
